server:
  port: 8080

spring:
  application:
    name: api-gateway
  cloud:
    gateway:
      discovery:
        locator:
          enabled: true
          lower-case-service-id: true
      
      # â­ CORS ì „ì—­ ì„¤ì •
      globalcors:
        add-to-simple-url-handler-mapping: true
        cors-configurations:
          '[/**]':
            allowedOrigins:
              - "http://localhost:3000"
              - "http://localhost:5173"
            allowedMethods:
              - "*"
            allowedHeaders:
              - "*"
            allowCredentials: true
            maxAge: 3600

# ============================================================
# ğŸ”§ Gateway ë¼ìš°íŒ… ì„¤ì • (ìŠ¤ì¼€ì¼ ì•„ì›ƒìš©)
# ============================================================
gateway:
  routes:
    strip-prefix: 1
    
    # User Service ì„¤ì •
    user:
      service-uri: lb://user-service
      auth-path: /api/auth/**
      api-path: /api/users/**
    
    # Product Service ì„¤ì •
    product:
      service-uri: lb://product-service
      api-path: /api/products/**
      require-auth: false
    
    # Order Service ì„¤ì •
    order:
      service-uri: lb://order-service
      api-path: /api/orders/**
      require-auth: true
    
    # Board Service ì„¤ì •
    board:
      service-uri: lb://board-service
      api-path: /api/boards/**
      search-path: /api/boards/search/**
      public-methods:
        - GET
      auth-methods:
        - POST
        - PUT
        - DELETE

  # ============================================================
  # ğŸ” Security ê²½ë¡œ ì„¤ì • (ìŠ¤ì¼€ì¼ ì•„ì›ƒìš©)
  # ============================================================
  security:
    authenticate-all: false
    
    public-paths:
      auth:
        - /api/auth/**
        - /auth/**
      
      boards-get:
        - /api/boards/**
        - /boards/**
      
      products-get:
        - /api/products/**
      
      orders:
        - /api/orders/**
      
      actuator:
        - /actuator/**
    
    authenticated-paths:
      boards-write:
        - /api/boards/**

# Eureka ì„¤ì •
eureka:
  client:
    service-url:
      defaultZone: http://localhost:8761/eureka/
    register-with-eureka: true
    fetch-registry: true
  instance:
    prefer-ip-address: true
    lease-renewal-interval-in-seconds: 10

# JWT ì„¤ì •
jwt:
  secret: your-secret-key-must-be-at-least-256-bits-long-for-HS256-algorithm
  expiration: 86400000

# Actuator ì„¤ì •
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,gateway,refresh
  endpoint:
    health:
      show-details: always
    refresh:
      enabled: true

# ë¡œê¹… ì„¤ì •
logging:
  level:
    root: INFO
    com.enterprise.gateway: DEBUG
    org.springframework.cloud.gateway: DEBUG
    org.springframework.web.cors: DEBUG
    org.springframework.security: DEBUG

---
# ============================================================
# ğŸ› ï¸ ê°œë°œ í™˜ê²½ í”„ë¡œíŒŒì¼
# ============================================================
spring:
  config:
    activate:
      on-profile: dev

gateway:
  security:
    authenticate-all: false
    public-paths:
      orders:
        - /api/orders/**

logging:
  level:
    com.enterprise.gateway: TRACE

---
# ============================================================
# ğŸš€ í”„ë¡œë•ì…˜ í™˜ê²½ í”„ë¡œíŒŒì¼
# ============================================================
spring:
  config:
    activate:
      on-profile: prod
  cloud:
    gateway:
      globalcors:
        cors-configurations:
          '[/**]':
            allowedOrigins:
              - "https://yourdomain.com"
            allowedMethods:
              - GET
              - POST
              - PUT
              - DELETE
            allowedHeaders:
              - "*"
            allowCredentials: true
            maxAge: 3600

gateway:
  security:
    authenticate-all: true
    public-paths:
      orders: []
    authenticated-paths:
      orders:
        - /api/orders/**

logging:
  level:
    root: WARN
    com.enterprise.gateway: INFO

---
# ============================================================
# ğŸ§ª ìŠ¤í…Œì´ì§• í™˜ê²½ í”„ë¡œíŒŒì¼
# ============================================================
spring:
  config:
    activate:
      on-profile: staging

gateway:
  security:
    authenticate-all: true
    public-paths:
      orders: []

logging:
  level:
    com.enterprise.gateway: DEBUG